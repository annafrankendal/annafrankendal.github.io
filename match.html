<!DOCTYPE html>
<html lang="sv">
<head>
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-KD8Z8J5B');</script>
<!-- End Google Tag Manager -->

  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Matchningstest | Anna Frankendal</title>

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&family=Playfair+Display:ital,wght@0,700;0,900;1,700;1,900&display=swap" rel="stylesheet">

  <style>
    :root {
      --bg: #fdfaf6;
      --ink: #1a1a1a;
      --navy: #1b263b;
      --burgundy: #630d16;
      --lightblue: #d1e8ff;
      --border: 1.5px solid #1a1a1a;
      --font-display: 'Playfair Display', serif;
      --font-body: 'Space Grotesk', sans-serif;
      --radius: 12px;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      background: var(--bg);
      color: var(--ink);
      font-family: var(--font-body);
      line-height: 1.4;
      -webkit-font-smoothing: antialiased;
    }

    .container { max-width: 900px; margin: 0 auto; padding: 0 2rem; }

    /* --- CONTACT BAR --- */
    .contact-bar {
      background: #000; color: #fff; padding: 12px 30px; display: flex; justify-content: center; gap: 30px;
      font-size: 10px; text-transform: uppercase; letter-spacing: 2px; position: sticky; top: 0; width: 100%; z-index: 2000;
      flex-wrap: wrap;
    }
    .contact-bar a { color: #fff; text-decoration: none; font-weight: 600; }

    /* --- NAVIGATION --- */
    nav { 
      background: rgba(255,255,255,0.9); backdrop-filter: blur(10px); padding: 1.5rem 2rem; display: flex; 
      justify-content: center; align-items: center; gap: 3rem; position: sticky; top: 39px; 
      border-bottom: var(--border); z-index: 1500; text-transform: uppercase; font-size: 11px; font-weight: 700; letter-spacing: 2px;
    }
    nav a { color: var(--ink); text-decoration: none; transition: color 0.3s; }
    nav a:hover { color: var(--burgundy); }
    nav .active { color: var(--burgundy); border-bottom: 2px solid var(--burgundy); padding-bottom: 4px; }
    .nav-cta { padding: 10px 16px; border-radius: 999px; text-decoration: none; background: var(--burgundy); color: #fff !important; }

    /* --- MATCH HEADER --- */
    header { padding: 8rem 0 4rem; text-align: center; }
    header h1 { font-family: var(--font-display); font-size: clamp(3rem, 10vw, 6rem); font-weight: 900; line-height: 0.8; text-transform: uppercase; letter-spacing: -4px; margin-bottom: 2rem; color: var(--navy); }
    header p { font-size: 1.5rem; font-family: var(--font-display); font-weight: 700; font-style: italic; color: var(--ink); }

    /* --- QUIZ CARD (OLD LAYOUT) --- */
    .quiz-card {
      background: #fff; border: var(--border); border-radius: var(--radius);
      max-width: 760px; margin: 0 auto 10rem; overflow: hidden;
    }
    
    .topbar { 
      padding: 30px 40px 20px; border-bottom: 1px solid var(--border); 
      display: flex; justify-content: space-between; align-items: center; background: #fff;
    }
    
    .match-bar { height: 6px; width: 200px; background: var(--lightblue); border-radius: 999px; overflow: hidden; }
    .match-fill { height: 100%; width: 0%; background: var(--navy); transition: width .3s ease; }
    
    .quiz-body { padding: 52px 40px 44px; }
    .q-text {
      font-family: var(--font-display);
      font-size: clamp(2rem, 3.3vw, 3.2rem);
      line-height: 1.14;
      margin-bottom: 36px;
      font-weight: 900;
      color: var(--ink);
      letter-spacing: -0.5px;
      max-width: 16ch;
    }
    
    .scale-wrap { display: inline-block; }
    .scale { display: flex; gap: 14px; margin-bottom: 10px; width: max-content; }
    .chip {
      width: 76px; height: 76px; border-radius: 50%; border: 1px solid #bfc3cc;
      background: #fff; color: #000; font-weight: 600; cursor: pointer;
      transition: all 0.2s ease; font-family: var(--font-body); font-size: 22px;
      display: flex; align-items: center; justify-content: center;
    }
    .chip:hover { border-color: var(--navy); transform: translateY(-1px); }
    .chip.selected { background: var(--navy); border-color: var(--navy); color: #fff; }
    .scale-hint { color: #666; font-size: 12px; margin-bottom: 8px; text-transform: uppercase; letter-spacing: 1px; font-weight: 600; }

    .scaleLegend { display: flex; justify-content: space-between; color: #8a8a8a; font-size: 11px; margin-top: 6px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.6px; width: 100%; }
    .scaleLegend span:last-child { text-align: right; }
    .form-note { font-size: 12px; color: #666; margin-top: 10px; }

    .quiz-nav { display: flex; justify-content: space-between; padding: 0 40px 40px; margin-top: 12px; }
    .btn { padding: 12px 24px; border-radius: 8px; font-weight: 700; text-transform: uppercase; letter-spacing: 1px; border: var(--border); cursor: pointer; transition: 0.2s; font-family: var(--font-body); }
    .btn-primary { background: var(--navy); color: #fff; }
    .btn-ghost { background: transparent; color: var(--ink); }
    .btn:disabled { opacity: 0.3; cursor: not-allowed; }

    /* --- RESULT --- */
    .result-reward { text-align: center; padding: 40px; }
    .result-reward .pct { font-family: var(--font-display); font-size: 6rem; font-weight: 900; color: var(--navy); }
    .result-reward .title { font-size: 2rem; font-weight: 900; margin: 1rem 0; text-transform: uppercase; }

    footer { padding: 80px 0 40px; text-align: center; border-top: var(--border); }
    footer h2 { font-family: var(--font-display); font-size: clamp(2rem, 4vw, 3rem); font-weight: 900; margin-bottom: 2rem; line-height: 1.15; color: var(--navy); text-transform: uppercase; letter-spacing: 3px; }
    .footer-sub { margin-top: 40px; letter-spacing: 4px; font-size: 0.9rem; font-weight: 700; color: var(--navy); display: block; text-transform: uppercase; }
    .footer-icons { margin-top: 40px; display: flex; justify-content: center; gap: 40px; }
    .footer-links a { color: var(--ink); font-size: 2.5rem; opacity: 0.8; transition: all 0.2s ease; display: inline-block; }
    .footer-links a:hover { transform: translateY(-3px); opacity: 1; color: var(--navy); }
    .footer-copyright { margin-top: 80px; font-size: 0.8rem; letter-spacing: 2px; opacity: 0.6; text-transform: uppercase; }

    @media (max-width: 700px) {
      .quiz-body { padding: 36px 20px 28px; }
      .q-text { font-size: 2rem; max-width: 100%; }
      .scale { gap: 10px; }
      .chip { width: 56px; height: 56px; font-size: 1.1rem; }
      .match-bar { width: 120px; }
      .quiz-nav { padding: 0 20px 28px; }
    }
  </style>
</head>
<body>
 
  <div class="contact-bar">
    <a href="mailto:afrankendal@gmail.com">afrankendal@gmail.com</a>
    <a href="tel:+46707595554">070-759 55 54</a>
    <a href="https://www.linkedin.com/in/annafrankendal/" target="_blank">LinkedIn</a>
    <a href="https://www.instagram.com/frankisfood/" target="_blank">Instagram</a>
    <a href="https://www.tiktok.com/@frankisfood" target="_blank">TikTok</a>
  </div>

  <nav>
    <a href="index.html">Hem</a>
    <a href="about.html">Om mig</a>
    <a href="projects.html">Projekt</a>
    <a href="experience.html">CV</a>
    <a href="match.html" class="nav-cta active">츿r vi en match?</a>
  </nav>

  <header>
    <div class="container">
      <h1>Match.</h1>
      <p>Hitta r칛tt samarbetsform</p>
    </div>
  </header>

  <main class="container">
    <!-- ENTRY CARD -->
    <div id="quizEntry" class="quiz-card" style="padding: 80px 60px; text-align: center;">
      <h2 style="font-size: 3rem; margin-bottom: 1.5rem;">츿r vi en match?</h2>
      <p style="font-size: 1.2rem; margin-bottom: 3rem; max-width: 600px; margin-left: auto; margin-right: auto;">Svara p친 fyra korta fr친gor om hur ni arbetar idag. Det tar mindre 칛n en minut och ger en tydlig bild av hur v친ra arbetss칛tt matchar.</p>
      <button id="startQuizBtn" class="btn btn-primary" style="padding: 20px 40px;">Starta testet</button>
    </div>

    <!-- QUIZ CARD -->
    <div id="quizCard" class="quiz-card" style="display: none;">
      <div class="topbar">
        <div class="kicker" id="kicker" style="margin-bottom:0;">Fr친ga 1 av 4</div>
        <div class="match-bar"><div id="matchBarFill" class="match-fill"></div></div>
      </div>

      <form id="matchForm" novalidate>
        <div class="quiz-body">
          <!-- Steps -->
          <div class="step active" data-step="1">
            <p class="q-text">Hos oss f친r marknadsf칬ring ta ansvar f칬r b친de id칠 och strategisk riktning.</p>
            <div class="scale-wrap">
              <div class="scale-hint">Skala 1-5</div>
              <div class="scale" data-q="q1">
                <div class="chip" data-value="1">1</div>
                <div class="chip" data-value="2">2</div>
                <div class="chip" data-value="3">3</div>
                <div class="chip" data-value="4">4</div>
                <div class="chip" data-value="5">5</div>
              </div>
              <div class="scaleLegend"><span>St칛mmer inte alls</span><span>St칛mmer helt</span></div>
            </div>
          </div>

          <div class="step" data-step="2" style="display:none;">
            <p class="q-text">Vi kan tydligt f칬rklara varf칬r vi g칬r det vi g칬r i v친ra kanaler.</p>
            <div class="scale-wrap">
              <div class="scale-hint">Skala 1-5</div>
              <div class="scale" data-q="q2">
                <div class="chip" data-value="1">1</div>
                <div class="chip" data-value="2">2</div>
                <div class="chip" data-value="3">3</div>
                <div class="chip" data-value="4">4</div>
                <div class="chip" data-value="5">5</div>
              </div>
              <div class="scaleLegend"><span>St칛mmer inte alls</span><span>St칛mmer helt</span></div>
            </div>
          </div>

          <div class="step" data-step="3" style="display:none;">
            <p class="q-text">Vi arbetar mot tydliga m친l och f칬ljer upp det vi skapar.</p>
            <div class="scale-wrap">
              <div class="scale-hint">Skala 1-5</div>
              <div class="scale" data-q="q3">
                <div class="chip" data-value="1">1</div>
                <div class="chip" data-value="2">2</div>
                <div class="chip" data-value="3">3</div>
                <div class="chip" data-value="4">4</div>
                <div class="chip" data-value="5">5</div>
              </div>
              <div class="scaleLegend"><span>St칛mmer inte alls</span><span>St칛mmer helt</span></div>
            </div>
          </div>

          <div class="step" data-step="4" style="display:none;">
            <p class="q-text">Vi prioriterar att bygga relationer med v친r m친lgrupp 칬ver tid.</p>
            <div class="scale-wrap">
              <div class="scale-hint">Skala 1-5</div>
              <div class="scale" data-q="q4">
                <div class="chip" data-value="1">1</div>
                <div class="chip" data-value="2">2</div>
                <div class="chip" data-value="3">3</div>
                <div class="chip" data-value="4">4</div>
                <div class="chip" data-value="5">5</div>
              </div>
              <div class="scaleLegend"><span>St칛mmer inte alls</span><span>St칛mmer helt</span></div>
            </div>
            
            <div style="margin-top: 3rem;">
              <input id="matchEmail" type="email" placeholder="Din mailadress" style="width:100%; padding:15px; border:var(--border); border-radius:8px; font-family:var(--font-body); font-size:1.1rem;" required>
              <div style="display:flex; gap:10px; margin-top:1.5rem; align-items:center; font-size:0.9rem;">
                <input id="matchConsent" type="checkbox" required>
                <span>Jag godk칛nner att min e-post och mina testsvar sparas f칬r 친terkoppling. <a href="privacy.html">L칛s integritetspolicy</a>.</span>
              </div>
              <p class="form-note">Du beh칬ver v칛lja ett svar, fylla i mail och godk칛nna 친terkoppling f칬r att visa resultat.</p>
            </div>
          </div>

          <div id="matchResult" style="display:none;"></div>
        </div>

        <div class="quiz-nav">
          <button id="matchPrevBtn" class="btn btn-ghost" type="button" style="visibility:hidden;">Bak친t</button>
          <button id="matchNextBtn" class="btn btn-primary" type="button" disabled>N칛sta</button>
          <button id="matchSubmitBtn" class="btn btn-primary" type="submit" style="display:none;">Visa resultat</button>
        </div>
      </form>
    </div>
  </main>

  <footer>
    <div class="container">
      <h2>Ska vi koka ihop<br>n친got bra?</h2>
      <span class="footer-sub">Just lurking? Come say hi:</span>
      <div class="footer-icons footer-links">
        <a href="mailto:afrankendal@gmail.com" title="Mail"><i class="far fa-envelope"></i></a>
        <a href="tel:+46707595554" title="Telefon"><i class="fas fa-mobile-alt"></i></a>
        <a href="https://www.linkedin.com/in/annafrankendal/" target="_blank" title="LinkedIn"><i class="fab fa-linkedin"></i></a>
        <a href="https://www.instagram.com/frankisfood/" target="_blank" title="Instagram"><i class="fab fa-instagram"></i></a>
        <a href="https://www.tiktok.com/@frankisfood" target="_blank" title="TikTok"><i class="fab fa-tiktok"></i></a>
      </div>
      <p class="footer-copyright">춸 2025 Anna Frankendal</p>
    </div>
  </footer>

  <!-- Floating Chat Interface -->
  <button class="chat-trigger" onclick="toggleChat()">游눫</button>
  
  <div id="ai-chat-container">
    <div class="ai-chat-hero">
      <h2>Testa hur jag t칛nker</h2>
      <p>Vad st친r i v칛gen f칬r er digitala tillv칛xt? Beskriv det och se hur jag skulle arbeta med det.</p>
    </div>
    <div id="chat-display"></div>
    <div class="chat-suggestions">
      <button type="button" class="chip">Varf칬r f친r vi f친 klick?</button>
      <button type="button" class="chip">Varf칬r blir det inga k칬p?</button>
      <button type="button" class="chip">Hur f친r vi kunder att stanna?</button>
    </div>    
    <div class="chat-controls">
      <input type="text" id="chat-input" placeholder="Beskriv ett problem...">
      <button id="send-btn">Fr친ga</button>
    </div>
  </div>

  <link rel="stylesheet" href="chat-style.css">
  <script src="script.js"></script>

  <script>
    const matchAnswers = { q1:null, q2:null, q3:null, q4:null };
    let matchStep = 1;
    const matchTotalSteps = 4;
    const matchEmailInput = document.getElementById('matchEmail');
    const matchConsentInput = document.getElementById('matchConsent');
    const matchSubmitBtn = document.getElementById('matchSubmitBtn');
    const matchForm = document.getElementById('matchForm');
    let autoAdvanceTimer = null;

    function getApiBase() {
      return window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1'
        ? 'http://localhost:3000'
        : 'https://anna-backend-live.onrender.com';
    }

    function isFinalStepValid() {
      return Boolean(matchAnswers.q4) && matchEmailInput.checkValidity() && matchConsentInput.checked;
    }

    function updateSubmitState() {
    }

    function showMatchResult(pct) {
      document.querySelector('.quiz-body').style.display = 'none';
      document.querySelector('.quiz-nav').style.display = 'none';
      const res = document.getElementById('matchResult');
      res.style.display = 'block';
      res.innerHTML = `
        <div class="result-reward">
          <div class="pct">${pct}%</div>
          <div class="title">Matchning klar</div>
          <p>Det h칛r ser sp칛nnande ut. Vi borde h칬ras!</p>
          <a href="mailto:afrankendal@gmail.com" class="btn btn-primary" style="text-decoration:none; margin-top:2rem; display:inline-block;">Kontakta mig</a>
        </div>
      `;
    }

    async function saveLeadInBackground(payload) {
      const endpoint = `${getApiBase()}/api/match-lead`;
      for (let attempt = 0; attempt < 2; attempt += 1) {
        try {
          const response = await fetch(endpoint, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(payload)
          });
          if (response.ok) return true;
        } catch (error) {
          // Silent fallback for user; we only retry once.
        }
      }
      return false;
    }

    function showMatchStep(n){
      if (autoAdvanceTimer) {
        clearTimeout(autoAdvanceTimer);
        autoAdvanceTimer = null;
      }
      matchStep = n;
      document.querySelectorAll('.step').forEach((s, idx) => {
        s.style.display = (idx + 1 === matchStep) ? 'block' : 'none';
      });
      document.getElementById('kicker').textContent = `Fr친ga ${matchStep} av ${matchTotalSteps}`;
      document.getElementById('matchBarFill').style.width = (matchStep / matchTotalSteps * 100) + '%';
      document.getElementById('matchPrevBtn').style.visibility = matchStep > 1 ? 'visible' : 'hidden';
      
      if (matchStep === matchTotalSteps){
        document.getElementById('matchNextBtn').style.display = 'none';
        document.getElementById('matchSubmitBtn').style.display = 'inline-block';
        document.getElementById('matchSubmitBtn').disabled = false;
        updateSubmitState();
      } else {
        document.getElementById('matchNextBtn').style.display = 'inline-block';
        document.getElementById('matchSubmitBtn').style.display = 'none';
        document.getElementById('matchNextBtn').disabled = !matchAnswers['q'+matchStep];
      }
    }

    document.querySelectorAll('.scale .chip').forEach(c => {
      c.addEventListener('click', () => {
        const q = c.parentElement.dataset.q;
        matchAnswers[q] = Number(c.dataset.value);
        c.parentElement.querySelectorAll('.chip').forEach(chip => chip.classList.remove('selected'));
        c.classList.add('selected');
        if (matchStep < matchTotalSteps) {
          document.getElementById('matchNextBtn').disabled = false;
          autoAdvanceTimer = setTimeout(() => {
            if (matchStep < matchTotalSteps && matchAnswers['q' + matchStep]) {
              showMatchStep(matchStep + 1);
            }
          }, 500);
        }
        updateSubmitState();
      });
    });

    matchEmailInput.addEventListener('input', updateSubmitState);
    matchConsentInput.addEventListener('change', updateSubmitState);

    document.getElementById('startQuizBtn').addEventListener('click', () => {
      document.getElementById('quizEntry').style.display = 'none';
      document.getElementById('quizCard').style.display = 'block';
      showMatchStep(1);
    });

    document.getElementById('matchPrevBtn').addEventListener('click', () => showMatchStep(matchStep - 1));
    document.getElementById('matchNextBtn').addEventListener('click', () => showMatchStep(matchStep + 1));

    matchForm.addEventListener('submit', (e) => {
      e.preventDefault();
      if (!isFinalStepValid()) {
        if (!matchEmailInput.checkValidity()) {
          matchEmailInput.reportValidity();
        } else if (!matchConsentInput.checked) {
          alert('Du beh칬ver godk칛nna 친terkoppling via mail f칬r att g친 vidare.');
        } else if (!matchAnswers.q4) {
          alert('V칛lj ett svar p친 fr친ga 4 f칬rst.');
        }
        return;
      }
      matchSubmitBtn.disabled = true;
      matchSubmitBtn.textContent = 'Sparar...';

      const total = Object.values(matchAnswers).reduce((a,b) => a+b, 0);
      const pct = Math.round((total / 20) * 100);
      const payload = {
        email: matchEmailInput.value.trim(),
        consent: matchConsentInput.checked,
        answers: matchAnswers,
        score: total,
        percentage: pct
      };

      showMatchResult(pct);
      saveLeadInBackground(payload);
    });
  </script>
</body>
</html>
